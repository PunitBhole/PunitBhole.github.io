<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>
body {font-family: Arial, Helvetica, sans-serif;
background-image: url("grey1.jpg");
  background-repeat: no-repeat;
  background-attachment: fixed;}

/* Full-width input fields */
input[type=text], input[type=password] {
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    box-sizing: border-box;
}

h1,h2,h3,h4,h5,h6 {
  margin-bottom: 0px;
  line-height: 0.7em;
}

/* Set a style for all buttons */
button {
    background-color: #4CAF50;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    width: 100%;
}

button:hover {
    opacity: 0.8;
}

/* Extra styles for the cancel button */
.cancelbtn {
    width: auto;
    padding: 10px 18px;
    background-color: #f44336;
}

/* Center the image and position the close button */
.imgcontainer {
    text-align: center;
    margin: 24px 0 12px 0;
    position: relative;
}

img.avatar {
    width: 40%;
    border-radius: 50%;
}

.container {
    padding: 16px;
}

span.psw {
    float: right;
    padding-top: 16px;
}

/* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    padding-top: 60px;
}

/* Modal Content/Box */
.modal-content {
    background-color: #fefefe;
    margin: 5% auto 15% auto; /* 5% from the top, 15% from the bottom and centered */
    border: 1px solid #888;
    width: 85%; /* Could be more or less, depending on screen size */
    
    overflow-y: auto;
}

/* The Close Button (x) */
.close {
    position: absolute;
    right: 25px;
    top: 0;
    color: #000;
    font-size: 35px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: red;
    cursor: pointer;
}

/* Add Zoom Animation */
.animate {
    -webkit-animation: animatezoom 0.6s;
    animation: animatezoom 0.6s
}

@-webkit-keyframes animatezoom {
    from {-webkit-transform: scale(0)} 
    to {-webkit-transform: scale(1)}
}
    
@keyframes animatezoom {
    from {transform: scale(0)} 
    to {transform: scale(1)}
}

/* Change styles for span and cancel button on extra small screens */
@media screen and (max-width: 300px) {
    span.psw {
       display: block;
       float: none;
    }
    .cancelbtn {
       width: 100%;
    }
}
</style>
</head>
<body>

<h2 align="center">DBMS Codes</h2><br>
<center>
<button onclick="document.getElementById('id01').style.display='block'" style="width:auto;">SQL DDL Commands</button><br>
<button onclick="document.getElementById('id02').style.display='block'" style="width:auto;">Job and Employee</button><br>
<button onclick="document.getElementById('id03').style.display='block'" style="width:auto;">Shipment</button><br>
<button onclick="document.getElementById('id04').style.display='block'" style="width:auto;">PL/SQL</button><br>
<button onclick="document.getElementById('id05').style.display='block'" style="width:auto;">Cursor </button><br>
<button onclick="document.getElementById('id06').style.display='block'" style="width:auto;">Triggers </button><br>
<!--
<button onclick="document.getElementById('id07').style.display='block'" style="width:auto;">Rational </button><br>
<button onclick="document.getElementById('id08').style.display='block'" style="width:auto;">Polynomial</button><br>
<button onclick="document.getElementById('id09').style.display='block'" style="width:auto;">Linked</button><br>
<button onclick="document.getElementById('id10').style.display='block'" style="width:auto;">Queue</button><br>
<button onclick="document.getElementById('id11').style.display='block'" style="width:auto;">Deque </button><br>
<button onclick="document.getElementById('id12').style.display='block'" style="width:auto;">Stack </button><br>
<button onclick="document.getElementById('id13').style.display='block'" style="width:auto;">Sorting </button><br>
<button onclick="document.getElementById('id14').style.display='block'" style="width:auto;">Template </button><br> -->

</center>

<div id="id01" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container">
      <pre>
	
      Question: Create a database Called COMPANY consisting of two tables - EMP & DEPT
            mysql> create table DEPT(DEPTNO integer(100) primary key,
                -> DNAME varchar(200),
                -> LOC varchar (100));
            mysql> desc DEPT;
            mysql> create table EMP(EMPNO integer(100) primary key AUTO_INCREMENT,
                -> ENAME varchar(100) NOT NULL,
                -> JOB char(100),
                -> MGR integer(100) NOT NULL,
                -> HIREDATE Date,
                -> SAL integer(100),
                -> COMM integer(100),
                -> DEPTNO integer(100),
                -> foreign key (DEPTNO) references DEPT(DEPTNO));
            mysql> desc EMP;

      Question: Alter Above table to add one more column AADHAR CARD no.(integer) 
            mysql> alter table EMP add AADHARNO int;
            mysql> desc EMP;

      Question: Alter Above table to change datatype of AADHAR CARD from integer to varchar.
            mysql> alter table EMP modify column AADHARNO varchar(12);
            mysql> desc EMP;

      Question: Drop AADHAR CARD column
            mysql> alter table EMP drop column AADHARNO;
            mysql> desc EMP;

      Question: Truncate Department table.
            mysql> truncate table DEPT;

      Question: Drop Department table
            mysql> drop table DEPT;

      Question: Create Department table with Deptno as Auto increment option.
            mysql> create table DEPT(DEPTNO integer(100) primary key AUTO_INCREMENT, DNAME varchar(200), LOC varchar (100));
            mysql> desc DEPT;

      Question: Alter employee table to add department no as foreign key.
            mysql> alter table EMP add foreign key (DEPTNO) references DEPT(DEPTNO);
            mysql> show create table EMP;

      Question: Create index on Salary
            mysql> create INDEX myind on EMP(SAL);

      Question: Create view for Employees who are belongs to department 20.
            mysql> select * from EMP where DEPTNO=20;

</pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>


<!-- 2nd code. -->



<div id="id02" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id02').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container">
      <pre>
        <h5>Title: Design at least 10 SQL queries for suitable database application using SQL DML statements: 
Insert, Select, Update, Delete with operators, functions, and set operator. 

Use database called COMPANY consisting of two tables: - EMP & DEPT
Insert 5 Rows in each Table.
Increment the salary of 7499 by 10% of his current salary.
Delete the Employee whose name starts P
Delete Employees who joined in Year 1980.
Increase the salary of Managers 
_______________________________________________________________________________</h5>
    <p>
Question: List employees not belonging to department 30, 40, or 10.
  mysql> select * from EMP where DEPTNO != 30 AND DEPTNO !=40 AND DEPTNO !=10;

Question: List the different designations in the company.
  mysql> select JOB from EMP;

Question: List the names of employees who are not eligible for commission.
  mysql> select ENAME from EMP where COMM=0;

Question: List employees whose names either start or end with “S”.
  mysql> select * from EMP where ENAME like 's%' or ENAME like '%s';

Question: List employees whose names have letter “A” as second letter” in their names.
  mysql> select * from EMP where ENAME like '_a%';

Question: List the number of employees working with the company.
  mysql> select count(*) from EMP;

Question: List the number of employees and average salary for employees in department 20.
  mysql> select count(*) ,avg(SAL) from EMP where DEPTNO=20;

Question: List name, salary and PF amount of all employees. (PF is calculated as 10% of basic salary) 
  mysql> select ENAME,SAL,0.10*SAL as PF from EMP;

Question: List names of employees who are more than 2 years old in the company.
  mysql> select ENAME From EMP where DATEDIFF(CURDATE(),HIREDATE)/365>2;

Question: List the employee details in the ascending order of their basic salary.
  mysql> select * from EMP order by SAL;

Question: List the department numbers and number of employees in each department.
  mysql> select count(*),DEPTNO from EMP group by DEPTNO;

Question: List the total salary, maximum and minimum salary and average salary of the employees, for department 20.
  mysql> select MIN(sal) as MINSAL, MAX(SAL) as MAXSAL,AVG(SAL) as AVGSAL,SUM(SAL) as TOTAL from EMP Where DEPTNO=20;

Question: Display the employees who have more salary as that of Smith
  mysql> select * FROM EMP WHERE SAL>(Select SAL FROM EMP WHere ENAME="Smith");


</p>
    </pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id02').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>



<!-- 3rd code. -->
<div id="id03" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id03').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container">
      <pre>
    <p>
Question:Create above tables with appropriate constraints like primary key, unique,default,foreign key, check constraints, not null etc. 
  mysql> create table customer(cust_id int primary key,cust_name varchar(20) not null,annual_rev bigint(20) default 1000,cust_type varchar(30) not null);
  mysql> desc customer; 
  mysql> create table truck(truck_no int primary key,driver_name varchar(20)); 
  mysql> desc truck; 
  mysql> create table city(city_name varchar(20) primary key,population bigint(20)); 
  mysql> desc city; 
  mysql>  create table shipment(shipment_id int primary key,cust_id int,weight float,truck_id int,destination varchar(20),ship_date date,
          foreign key (cust_id) references customer(cust_id),foreign key (truck_id) references truck(truck_no),foreign key(destination) references 
          city(city_name)); 
  mysql> desc shipment; 

Question:What are the names of customers who have sent packages (shipments) to Mumbai City?
  mysql> select cust_name,destination from customer c,shipment s where c.cust_id=s.cust_id and s.destination="mumbai";

Question:What are the names and populations of cities that have received shipments weighing over 50 Kg? 
  mysql> select city_name,population from city INNER JOIN shipment ON city.city_name=shipment.destination where weight>50; 
  OR 
  select destination,population from shipment s,city c where c.city_name=s.destination and s.weight>50;

Question:Who are the customers having over 500 in annual revenue who have sent shipments weighing less than 50 Kg? 
  mysql> select cust_name,annual_rev,destination from customer c1,shipment s where c1.cust_id = s.cust_id and c1.annual_rev>500 and s.weight<50; 
 
Question:Who are the customers having over 1000 in annual revenue who have sent shipments weighing less than 10 kg or have sent a shipment to Mumbai? 
  mysql> select cust_name,annual_rev,destination from customer c1,shipment s where c1.cust_id = s.cust_id and c1.annual_rev>500 and 
         (s.weight<10 or s.destination="mumbai"); 
 
Question:Who are the drivers who have delivered shipments for customers with annual revenue over 2000, to cities with populations over 1000?  
  mysql> select distinct driver_name from truck t,customer c,city ct,shipment s where s.truck_id = t.truck_no and c.cust_id=s.cust_id and 
         ct.city_name=s.destination and c.annual_rev>2000 and ct.population>1000; 

Question: Display customers who have same Annual Revenue as “Sunil”. 
  mysql> select cust_name from customer where annual_rev = (select annual_rev from customer where cust_name="sunil"); 
 
Question:Display shipments with weight greater than average weight of shipments. 
  mysql>  select shipment_id,weight from shipment where shipment.weight>(select avg(weight) from shipment); 
 
Question:Display no of shipments destination wise and display only those with more than 5 count. 
  mysql> select count(shipment_id),destination from shipment group by destination having count(shipment_id)>= 5; 
 
Question:Display the cities and populations with more than average population. 
  mysql> select city_name,population from city where population>(select avg(population) from city); 
 
Question:Display all the cities with their shipments if any.  
  mysql> select distinct  destination,shipment_id from city c, shipment s where c.city_name=s.destination; 
 
Question:Display all the shipments with the customers if any. Also display all customers with shipments if any. 
  mysql> select shipment_id,cust_name from shipment left join customer on shipment.cust_id=customer.cust_id  union  select shipment_id,cust_name from 
         customer left join shipment on customer.cust_id=shipment.cust_id ; 
 
Question: Create a View V1 to display Shipment ID,Destination where shipment sent to city whose population is greater than minimum population 
  mysql> create view v1 as select shipment_id,destination from shipment s,city c where s.destination=c.city_name and c.population>(select min(population) 
         from city); 
 
Question:Update above View V1 to display Shipment ID ,Customer ID along with Destination where shipment sent to city whose population is 
         greater than minimum population. 
  mysql> alter view v1 as select shipment_id,cust_id,destination from shipment s,city ct where  s.destination=ct.city_name and  
         ct.population>(select min(population) from city); 
 
Question:Drop View V1. 
  mysql> drop view v1; 
</p>
    </pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id03').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>



<!-- 4th Code -->
<div id="id04" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id04').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container"><font size="5">
      <pre><b>Q1. Calculate the Area of for radius 3, 4, 5,6,7,8. Display it.</b>
    <p>
SQL> SET SERVEROUTPUT ON;
     declare r float; 
     area float; 
     pi constant float:=3.142; 
     begin 
     for r in 3..8 
     loop area:=pi*r*r; 
     dbms_output.put_line('Radius: '||r||'  AREA:'||area); 
     end loop; 
     end; 
      / 
    

<b>Q2. Create a PL/SQL block that computes the commission amount for a given employee based on the 
  employee salary.

1. If the employee salary is less than $5,000, display the bonus amount for the employee as 10% of 
the salary.
2. If the employee salary is between $5,000 and $10,000, display the bonus amount for the employee 
as 15% of the salary.
3. If the employee salary exceeds $10,000, display the bonus amount for the employee as 20% of the 
salary.
4. If the employeeâ€™s salary is NULL, display the bonus amount for the employee as 0.
5. Test the PL/SQL block for each case using the following test cases, and check each bonus amount.</b>
      
   
SQL> create table emp(emp_id number,comm number,bonus number,sal number); 
SQL> desc emp;
SQL> insert into emp values(1,100,1000,10000); 
SQL> insert into emp values(2,200,2000,20000); 
SQL> insert into emp values(3,300,3000,30000); 
SQL> insert into emp values(4,450,3400,35000); 
SQL> insert into emp values(5,500,4000,55000);
SQL> insert into emp values(6,500,400,4000); 
SQL> insert into emp values(7,500,400,3000);
SQL> insert into emp values(8,500,400,2456); 

SQL> select * from emp;
    
SQL>declare salary number; 
    bonuscal number; 
    empno number;
    begin empno:=&empno; 
    select sal into salary from emp where emp_id=empno; 
    if salary <= 5000 then bonuscal:=salary*0.1; 
    update emp set bonus=bonuscal where emp_id=empno; 
    dbms_output.put_line('Bonus for employee '||empno||' is: '||bonuscal); 
    elsif salary > 5000 and salary <= 10000 then bonuscal:=salary*0.15; 
    update emp set bonus=bonuscal where emp_id=empno; dbms_output.put_line('Bonus for employee '||empno||' is: '||bonuscal); elsif salary >= 20000 then bonuscal:=salary*0.2; update emp set bonus=bonuscal where emp_id=empno; dbms_output.put_line('Bonus for employee '||empno||' is: '||bonuscal); elsif salary is null then dbms_output.put_line('Salary is NULL'); end if; end; 
    / 


<b>Q3. Write a PL/SQL block for following requirement and handle the exceptions. Roll no. of student 
will be entered by user. Attendance of roll no. entered by user will be checked in Stud table. If 
attendance is less than 75% then display the message “Term not granted” and set the status in stud 
table as “D”. Otherwise display message “Term granted” and set the status in stud table as “ND</b>

SQL> create table stud11(roll number primary key,att number,status char(6)); 

SQL> select *from stud11; 

SQL>Declare 
    mroll number; 
    matt number; 
    Begin mroll:= &mroll; 
    select att into matt from stud11 where roll = mroll; 
    if matt<75 then 
    dbms_output.put_line(mroll||'is detained'); 
    update stud11 set status='D'where roll=mroll; 
    else dbms_output.put_line(mroll||'is Not detained'); 
    update stud11 set status='ND'where roll=mroll; 
    end if; 
    Exception when no_data_found then dbms_output.put_line(mroll||'Not found'); 
    End; 
    /

SQL> select *from stud11;


<b>Q4. Write a PL/SQL block for following requirement using user defined exception handling. The 
account_master table records the current balance for an account, which is updated whenever, any 
deposits or withdrawals takes place. If the withdrawal attempted is more than the current balance 
held in the account. The user defined exception is raised, displaying an appropriate message. Write 
a PL/SQL block for above requirement using user defined exception handling</b>

SQL> create table account_master(accountno number primary key,currentbalance number) ;
SQL> desc account_master; 
SQL> insert into account_master(accountno,currentbalance) values(112,5000);
SQL> insert into account_master(accountno,currentbalance) values(113,8000);
SQL> insert into account_master(accountno,currentbalance) values(114,500);
SQL> insert into account_master(accountno,currentbalance) values(115,15000);
SQL> insert into account_master(accountno,currentbalance) values(116,1200);

SQL>CREATE OR REPLACE PROCEDURE withdrawal_proc(accountno_in IN account_master.accountno%type,
    w_amount IN NUMBER) IS  
    current_balance number(20);  
    ex_invalid_amount  EXCEPTION; 
    BEGIN  
    select currentbalance into current_balance from account_master where accountno = accountno_in; 

    if current_balance < w_amount then   
    RAISE ex_invalid_amount;          
    else    
    update account_master set currentbalance = current_balance-w_amount where accountno = accountno_in; 
    dbms_output.put_line('Money has been withdrawn successfully'); 
    end if;  

    Exception 
    WHEN ex_invalid_amount THEN  
    dbms_output.put_line('The withdrawl amount entered is more than the current balance'); 
    END; 
    / 

SQL> exec withdrawal_proc(112,100)
SQL> exec withdrawal_proc(112,10000)


<b>Q5. Write an SQL code block these raise a user defined exception where business rule is voilated. BR for client_master table specifies when client trying to withdraw amount from account and the value of bal_due field is less than 0 handle the exception.</b>

SQL> create table client_master(clientno number primary key,bal_due number) ;  
SQL> insert into client_master values(112,5000);
SQL> insert into client_master values(113,10000);
SQL> insert into client_master values(114,96969);
SQL> insert into client_master values(115,80069); 
SQL> insert into client_master values(116,4500); 

SQL>CREATE OR REPLACE PROCEDURE violate_br(custno_in IN client_master.clientno%type,w_amount number) 
    IS  
    due_balance number(20);  
    ex_invalid_balance  EXCEPTION;     
    BEGIN    
    select bal_due into due_balance from client_master where clientno = custno_in;     

    if due_balance-w_amount <= 0  then   
    RAISE ex_invalid_balance;          
    else    
    update client_master set bal_due = bal_due - w_amount where clientno = custno_in;  
    dbms_output.put_line('Money has been withdrawn successfully');    
    end if;     

    Exception    
    WHEN ex_invalid_balance THEN  
    dbms_output.put_line('Business Rule Violated: Balance after withdrawl should not less than zero');    
    END;   
    /

SQL> exec violate_br(116,8000);
SQL> select * from client_master;
SQL> exec violate_br(112,500);
SQL> select * from client_master;


<b>Q6. Borrower(Roll_no, Name, DateofIssue, bookno,NameofBook, Status)  Fine(Roll_no,bookno,DateofFine 
  ,Amt) ∙ Accept roll_no & bookno from user. 
Check the number of days (from date of issue), if days are between 15 to 30 then fine amount will 
be Rs 5per day. ∙ If no. of days>30, per day fine will be Rs 50 per day & for days less than 30, 
Rs. 5 per day. ∙ After submitting the book, status will change from I to R. ∙  If condition of fine 
is true, then details will be stored into fine table. Also handles the exception by named exception 
handler or user define exception handler. </b>

SQL> Create table borrower(rollno number ,name varchar(10),doi date,bookno number ,book_name 
varchar(40),status char(5),primary key(rollno,bookno,doi)); create table fine(rollno number ,
bookno number ,dof date,amount number,primary key(rollno,bookno,dof)); 

SQL>(function to calculate the fine) 
    create or replace function cal_fine(resdate IN number,proll IN number) 
    return number is calculated_fine number; 
    froll number; 
    fbookno number; 
    fdof date; 
    begin 

    if resdate>15 and resdate<30 then 
    calculated_fine:=resdate*5; 
    elsif 
    resdate>=30 then 
    calculated_fine:=resdate*50; 
    end if; 

    froll:=proll; 
    select bookno into fbookno from borrower where rollno=proll; 
    fdof:=sysdate(); 
    insert into fine values(froll,fbookno,fdof,calculated_fine); 
    return(calculated_fine); 
    end; 
    /

    (Procedure that calls cal_fine()
    create or replace procedure cal_fine_proc(proll in number) is 
    curdate date; 
    tdate date; 
    resdate number; 
    fine number; 
    begin 
    select doi into tdate from borrower where rollno=proll; 
    curdate:=sysdate(); 
    SELECT TO_DATE(curdate,  'DD-MM-YYYY') -TO_DATE(tdate ,'DD-MM-YYYY') AS DateDiff into resdate FROM dual; 
    dbms_output.put_line('resdate '||resdate); 
    dbms_output.put_line('fine '||cal_fine(resdate,proll)); 

    exception 
    when NO_DATA_FOUND then 
    dbms_output.put_line('Data Not Found!'); 
    end; 
    /

SQL>  exec cal_fine_proc(104);
SQL> select * from fine


<b>Q7. Create a procedure, NEW_EMP, to insert a new employee into the EMPLOYEES table. The procedure 
  should contain a call to the VALID_DEPTID function to check whether the department ID specified for 
  the new employee exists in the DEPARTMENTS table. a. Create a function VALID_DEPTID to validate a 
  specified department ID. The function should return a integer value. 
 
1.Create function to check department validation  
2.Call that function from procedure  
3.If it returns true then insert data into employee table</b>

SQL> create table emp1(empid number,empname varchar(20),deptid number ); 
SQL> create table dept(deptno number,deptname varchar(10)); 
SQL> insert into DEPT values(010,'IT'); 
SQL> insert into DEPT values(050,'Civil'); 
SQL> insert into DEPT values(040,'Comp'); 
SQL> insert into dept values(020,'Mech'); 
SQL> select * from dept;

SQL>(function) 
    create or replace function valid_dept(deptid in number) return number is 
    counter number;  
    begin   
    select count(*) into counter from (select * from dept where deptno=deptid);                    

    if counter>0 then    
    return 1;  
    else  
    return 0;   
    end if;   
    end;  
    /

SQL>(procedure)
    create or replace procedure new_emp(eid in number,ename in emp1.empname%TYPE,deptno in number) is             
    present number;  
    invalid exception;   
    begin 
    present:=valid_dept(deptno);  

    if present=1 then  
    insert into emp1 values(eid,ename,deptno);   
    else   
    raise invalid;   
    end if;  

    EXCEPTION   
    when invalid then   
    dbms_output.put_line('The Department Id is not present in dept table!');  
    END;    
    /

SQL> exec new_emp(101,'Ram',020);
SQL> exec new_emp(102,'Shyam',110);
    </p>
    </pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id04').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>


<!-- CODE 5 -->


<div id="id05" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id05').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container">
      <pre>
    <p>
<b>Q1. Create a procedure to Retrieve employees one by one and print out a list of those employees 
currently working in the sales department (DEPARTMENT_ID = 80).  Use a cursor to retrieve employee 
numbers and names and display.</b>

SQL> create table employee(eid number primary key,ename varchar(20),salary number,deptno number);  
SQL> insert into employee values(101,'Alex',10000,20);   
SQL> insert into employee values(102,'John',15000,80);   
SQL> insert into employee values(103,'Zack',8500,80);   
SQL> insert into employee values(104,'Perry',6800,80);   
SQL> insert into employee values(105,'Tom',9500,40);   
SQL> insert into employee values(106,'Jerry',9500,80);  

SQL>create or replace procedure sales is    
    cursor emp_cursor is    
    select eid,ename from employee where deptno=80;    
    emp_record emp_cursor%ROWTYPE;    
    begin    
    open emp_cursor;    

    Loop    
    fetch emp_cursor into emp_record;    
    exit when emp_cursor%notfound;    
    dbms_output.put_line('employee details:'||' '||emp_record.eid||' '||emp_record.ename);   
    end loop;    
    close emp_cursor;   
    end;    
    /
 
 SQL> exec sales; 

 <b>Q.2.Create a PL/SQL block that determines the top employees with respect to salaries. Accept 
 a number n from the user where n represents the number of top n earners from the EMPLOYEES table. 
For example, to view the top five earners, enter 5.There should be no duplication in the salaries. 
If two employees earn the same salary, the salary should be picked up only once. Test a variety of 
special cases, such as n = 0 or where n is greater than the number of employees in the EMPLOYEES 
table</b>

SQL> create table employee(eid number primary key, ename varchar(20),salary number,deptno number);  
SQL> insert into employee values(101,'Alex',10000,20);  
SQL> insert into employee values(102,'John',15000,80);  
SQL> insert into employee values(103,'Zack',8500,80);   
SQL> insert into employee values(104,'Perry',6800,80);   
SQL> insert into employee values(105,'Tom',9500,40);   
SQL> insert into employee values(106,'Jerry',9500,80);  
SQL> insert into employee values(107,'James',15000,20);

SQL>create or replace procedure top(x IN number) is    
    invalid_x exception;   
    entries number;    
    cursor emp_cursor is    
    select distinct salary from employee order by salary desc;    
    emp_record emp_cursor%ROWTYPE;    
    begin   
    select count(*) into entries from employee;    

    if x > entries then   
    raise invalid_x;   
    end if;  

    open emp_cursor;    
    for counter in 1 .. x 

    loop   
    fetch emp_cursor into emp_record;    
    exit when emp_cursor%notfound;    
    dbms_output.put_line('employee details: '||emp_record.salary);   
    end loop;    

    close emp_cursor;   
    exception  
    when invalid_x then   
    dbms_output.put_line('Input number is grater than the total entries!');    
    end;    
    /

SQL> exec top(9)

</p>
    </pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id05').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>



<!-- 6th code -->

<div id="id06" class="modal">
  
  <form class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <span onclick="document.getElementById('id06').style.display='none'" class="close" title="Close Modal">&times;</span>
      
    </div>

    <div class="container">
      <pre>
    <p>
<b>Q1. Changes to the data are allowed on the tables only during normal office hours of 08:45 am 
until 5:30 pm Monday to Friday  
1.Create  a stored procedure called secure_record that prevents the dml statement from executing 
during outside of normal office hours returning a message “u may only make the changes during normal
office hours”. 
2.reate  a statement trigger on any table that calls the above procedure </b>

SQL>Create table job (jobid number primary key,jtitle varchar(10))

SQL>CREATE OR REPLACE PROCEDURE secure_record    
    IS    
    BEGIN    
    IF TO_CHAR (SYSDATE,'HH24:MI') NOT BETWEEN '10:00' AND '17:30' OR TO_CHAR (SYSDATE, 'DY') IN ('SAT','SUN') THEN   
    RAISE_APPLICATION_ERROR (-20001, 'You may only make changes during normal office     hours.');   
    END IF;    
    END;    
    /  
 
    CREATE OR REPLACE TRIGGER secure_jobs  
    BEFORE INSERT OR UPDATE OR DELETE ON job  
    BEGIN  secure_record;  
    END secure_jobs;  
    /  


<b>Q. Employee should receive an automatic increases in the salary if the minimum salary for the job is increased 
 
1.Create a stored procedure update_emp_sal to update the salary amount. This procedure accepts
 2 parameters the jobid for which the salary has to be updated and the new minimum salary for this job. 
 This procedure is executed from the trigger on the jobs table. 
2.Create  a row trigger named update_emp_trigger on the job’s table that invokes the procedure 
  update_emp_sal 
when the minimum salary in job’s table is updated for the specified jobid </b>


SQL> create table jobsal (jobid number primary key,jtitle varchar(10),minsal number);  
SQL> create table empjob(eid number primary key,ename varchar(20),salary number,jobid number references 
      jobsal(jobid));  
SQL> insert into jobsal values(1,'security',2000);  
SQL> insert into empjob values(1,'suhas',500,1);  
SQL> select * from jobsal;  select * from empjob

SQL>CREATE OR REPLACE PROCEDURE upd_emp_sal  
    (p_job_id IN empjob.jobid%TYPE,  p_min_sal IN empjob.salary%TYPE)  IS  
    CURSOR c_emp_sal_update(cp_job_id empjob.jobid%TYPE) IS  
    SELECT salary  FROM empjob  WHERE jobid = cp_job_id  FOR UPDATE OF salary NOWAIT;  
    BEGIN  

    FOR v_c IN c_emp_sal_update(p_job_id)  
    LOOP  IF v_c.salary < p_min_sal THEN  
    UPDATE empjob SET salary = p_min_sal  WHERE CURRENT OF c_emp_sal_update;       
    END IF;  
    END LOOP;  

    END upd_emp_sal;  
    /  
     
    CREATE OR REPLACE TRIGGER update_emp_salary  
    AFTER INSERT OR UPDATE  OF minsal ON jobsal  

    FOR EACH ROW  BEGIN  IF :NEW.minsal > :OLD.minsal THEN  
    upd_emp_sal(:NEW.jobid, :NEW.minsal); 
    END IF;  
    END update_emp_salary;  
    / 


<b>Q.3 If some students are being deleted from the student table, it should be inserted in Alumni 
table with students details and date. Write a trigger for this task.</b>


SQL> create table currstud(prnno number primary key,sname varchar(20),doa date,branch varchar(10));  
SQL> create table alumnistud(prnno number ,sname varchar(20),doa date,branch varchar(10),docom date,
     primary key(prnno));  
SQL> insert into currstud values(101,'Jonny','09-jul-1997','IT');   
SQL> insert into currstud values(102,'Kallis','19-jun-1997','IT');   
SQL> insert into currstud values(103,'Peter','19-jun-1999','Civil');   
SQL> insert into currstud values(104,'Kate','23-jun-1998','Civil');   
SQL> insert into currstud values(105,'Martin','23-Dec-1997','Mech');   
SQL> insert into currstud values(106,'Lisa','28-oct-1998','Mech');  
 
SQL>create or replace procedure remove(prno number) is  
stdname currstud.sname%TYPE;  
admission_d currstud.doa%TYPE;  
std_branch currstud.branch%TYPE;  
begin  
 
select sname into stdname from currstud where prnno=prno;  
select doa into admission_d from currstud where prnno=prno;  
select branch into std_branch from currstud where prnno=prno;  
dbms_output.put_line('stdname : '||stdname);  
dbms_output.put_line('admission_d : '||admission_d);  
dbms_output.put_line('std_branch : '||std_branch);  
insert into alumnistud values(prno,stdname,admission_d,std_branch,sysdate());   

EXCEPTION   
WHEN no_data_found THEN    
dbms_output.put_line('Data does not exist.');  
END;  
/  
 
create or replace trigger put_into_alumni  
before delete on currstud  
begin  
remove(102);  
end put_into_alumni;  
/  



</p>
    </pre>
    </div>

    <div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id06').style.display='none'" class="cancelbtn">Cancel</button>
      
    </div>
  </form>
</div>


